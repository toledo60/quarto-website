{
  "hash": "763522a1aa13c074a9548b8d36785c2f",
  "result": {
    "markdown": "---\ntoc: true\n---\n\n\n\n\n\n## Overview of Hypothesis Testing\n\nA hypothesis test is a statistical technique used to evaluate competing claims using data. In hypothesis testing, we want to test two competing claims during an investigation. These two claims are known as *null hypothesis* and *alternative hypothesis*. Both of these claims then offer competing answers to our proposed research hypothesis\n\nThe null hypothesis $H_0$, assumes there is no significant difference or relationship between two variables being tested. It is used in hypothesis testing to determine if an observed result is statistically significant or simply due to chance\n\n\nThe alternative hypothesis $H_a$, contradicts the null hypothesis and suggests that there is a significant difference or relationship between the variables being tested. It is used in hypothesis testing to determine if there is evidence to support a particular research hypothesis\n\n## Inference Procedure \n\nHere are some general steps to performing an inference procedure\n\n1. Identify the population of interest and create a research hypothesis about the population \n2. Define the parameters of interest and state your null and alternative hypotheses. Specify a significance level $\\alpha$ before carrying out the test\n3. Gather a suitable sample for testing our hypothesis, and obtain the corresponding statistic\n4. Construct a sampling distribution under the null hypothesis and check the validity conditions to apply the Central Limit Theorem\n5. If the validity conditions hold, carry out the hypothesis test and obtain the $p$-value\n6. In the context of the investigation, make a conclusion by comparing the $p$-value to our significance level\n\nWe carry out this procedure in the following scenario using the `flint` dataset in our class website\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflint <- read.csv(file=\"/Users/toledo60/Desktop/Projects/personal-website/data/flint.csv\")\n```\n:::\n\n\nBelow is a preview of `flint` alongside its dimensions\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(flint)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>   Latitude Longitude Pb  Cu Region\n#> 1 43.09414 -83.60974  0   0  North\n#> 2 43.09054 -83.70344  1 130  North\n#> 3 43.08601 -83.71996 16 170  North\n#> 4 43.08100 -83.75415  0   0  North\n#> 5 43.07435 -83.70043  2   0  North\n#> 6 43.07399 -83.71788  0   0  North\n```\n:::\n\n```{.r .cell-code}\ndim(flint)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 541   5\n```\n:::\n:::\n\n\nIt is a dataset with 541 observations and 5 variables\n\n\nBased on the `flint` dataset, Lead levels are considered dangerous if the result was greater than or equal to 15PPB. We are interested in determining if the **proportion** of dangerous lead levels in Flint is greater than $10\\%$. Assume the Flint data is a random sample used to address this research question\n\n\n**Identify the population of interest and create a research hypothesis about the population**\n\nThe population of interest is the lead levels in flint. We are interested in determining if the *proportion* of dangerous lead levels *(lead levels greater than or equal to 15PPB)* in Flint is greater than $10\\%$\n\n<br/>\n**Define the parameters of interest and state your null and alternative hypotheses. Specify a significance level $\\alpha$ before carrying out the test**\n\nDenoting the population proportion with the symbol $\\pi$\n\nOur parameter of interest $\\pi$, is *proportion* of dangerous lead levels *(lead levels greater than or equal to 15PPB)* in Flint\n\nWe construct the following one-sided test\n\n$$\n\\begin{align*}\nH_0: \\pi &= 0.1 \\\\\nH_a: \\pi &> 0.1\n\\end{align*}\n$$\nWe are interested in testing whether or not the proportion of dangerous lead levels is greater than $10\\%$ *(this is our alternative hypothesis)*.\nWe perform this hypothesis test at the $\\alpha =0.05$ significance level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalpha <- 0.05\n```\n:::\n\n\n\n<br/>\n**Gather a suitable sample for testing our hypothesis, and obtain the corresponding statistic**\n\nWe assume the `flint` data is a random sample used to test our hypothesis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- nrow(flint)\ndangerous_lead <- (flint$Pb >= 15)\np_hat <- mean(dangerous_lead)\n```\n:::\n\n\nBased on our random sample, the sample proportion of lead levels in `flint` that are greater than or equal to 15PPB *(dangerous lead levels)* is \n\n\n::: {.cell}\n\n```{.r .cell-code}\np_hat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.1238447\n```\n:::\n:::\n\n\n*This will be our test statistic*\n\n\n<br/>\n\n**Construct a sampling distribution under the null hypothesis and check the validity conditions to apply the Central Limit Theorem**\n\nGiven that there\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn * p_hat # number of successes\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 67\n```\n:::\n\n```{.r .cell-code}\nn * (1-p_hat) # number of failures\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 474\n```\n:::\n:::\n\n\nat least 10 successes and 10 failures we can approximate the sampling distribution with a normal distribution. \n\nUnder the null hypothesis, we standardize our test statistic\n\n$$\nz = \\frac{\\hat{p} - \\pi}{ \\sqrt{\\frac{\\pi (1-\\pi)}{n}  }}\n$$\n\nwhere $\\pi$ is the null hypothesized value and $\\hat{p}$ is our sample proportion. This is known as the $z$-score. The $z$-score represents the number of standard errors that the sample proportion is from the population proportion\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_null <- 0.10\nse_null <- sqrt(p_null*(1-p_null)/n)\ntest_stat <- (p_hat-p_null)/se_null\n```\n:::\n\n\nOur test statistic is then \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_stat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 1.848714\n```\n:::\n:::\n\n\n**If the validity conditions hold, carry out the hypothesis test and obtain the $p$-value**\n\nThe $p$-value is defined as the probability of observing a test statistic giving us \"as much or more evidence in favor of the alternative hypothesis\" assuming the null distribution is true\n\nThat is we shade the region in whichever direction the alternative hypothesis is testing. In our case we are interested in values that are bigger than our equal $10\\%$ of dangerous lead proportion in Flint\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_value <- pnorm(test_stat,sd=1,mean=0, lower.tail = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.03224953\n```\n:::\n:::\n\n\n\n<details>\n<summary>Show Code</summary>\n\nThis code is not required for your lab, and is only used for teaching demonstration\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(patchwork)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_bw())\ntheme_replace(panel.grid.minor = element_blank(),\n              panel.grid.major = element_blank())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx_limits <- c(-4,4)\np1 <- ggplot(data.frame(x = x_limits), aes(x)) +\n  stat_function(fun = dnorm,\n                geom = \"line\",\n                xlim = x_limits) +\n  stat_function(fun = dnorm,\n                geom = \"area\",\n                fill = '#cf5d55',\n                alpha =0.3,\n                xlim = c(test_stat, 4))+\n  geom_vline(xintercept = test_stat,linetype=2,color = '#cf5d55')+\n  labs(x = '',y= 'Density')+\n  annotate(\"text\", x = test_stat+1.1, y = 0.07, \n           label = paste0('p-value = ',round(p_value,2)),\n           size=4.5)+\n  scale_x_continuous(name = '',limits = x_limits,\n                     breaks = -4:4)\n```\n:::\n\n\n</details>\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](hypothesis_testing_files/figure-html/unnamed-chunk-14-1.png){width=576}\n:::\n:::\n\n\n\n\n**In the context of the investigation, make a conclusion by comparing the $p$-value to our significance level**\n\nWe can make the following decisions in a hypothesis test\n\n* If $p$-value $\\leq \\alpha$: reject the null hypothesis \n* If $p$-value $> \\alpha$: fail to reject the null hypothesis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_value < alpha\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] TRUE\n```\n:::\n:::\n\n\n\nSince our $p$-value is less than our significance level,we have sufficient evidence to reject the null hypothesis in favor of the alternative hypothesis. That is, we can claim the proportion of dangerous lead levels in Flint is greater than $10\\%$\n\n\nWhile the above process can be tedious,it can easily be performed with a single command in R :)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_successes <- sum(dangerous_lead)\nprop.test(x = n_successes,n = n,p = 0.10,\n          alternative = 'greater',conf.level = 0.95,\n          correct = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> \t1-sample proportions test without continuity correction\n#> \n#> data:  n_successes out of n, null probability 0.1\n#> X-squared = 3.4177, df = 1, p-value = 0.03225\n#> alternative hypothesis: true p is greater than 0.1\n#> 95 percent confidence interval:\n#>  0.1024045 1.0000000\n#> sample estimates:\n#>         p \n#> 0.1238447\n```\n:::\n:::\n\n\n\nFor further details on `prop.test`, see `?prop.test`\n\n\n",
    "supporting": [
      "hypothesis_testing_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}