{
  "hash": "4d0a6f4f5e9938f33b16453186ecade2",
  "result": {
    "markdown": "---\nauthor: Jose Toledo Luna\ndate: 2023-04-24\ntitle: Python Virtual Environments\ndescription: a quick tutorial on python virtual environments using VS code\ntoc: true\ncomments: false\nexecute: \n  eval: false\n---\n\n## Overview of virtual environment\n\nLets say we had the following script `data_basics.py`. In this script, the code imports the NumPy and Pandas libraries and creates a random array using NumPy.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\n\nrng = np.random.default_rng(123)\nd = rng.random((3,2))\n\npd.DataFrame(data = d)\n```\n:::\n\n\nUsing a virtual environment can help us avoid version conflicts between different packages, especially when working on projects that require specific versions of dependencies. In this case \n`numpy > 1.17` to properly use `default_rng()`.\n\nIf you have multiple projects that use different versions of these libraries, you may run into version conflicts. By using a virtual environment, we can create an isolated environment with the specific versions of NumPy and Pandas that our project requires. This ensures that our code runs smoothly without any issues related to version incompatibilities. \n\nAdditionally, virtual environments also help with reproducibility and flexibility, making it easy to switch between different environments for different projects\n\n\n## Creating a virtual environment \n\nTo begin working on a project, open the folder or directory in your preferred editor, such as VS Code. For this example, let's assume we'll be working with a folder called `random_folder`, which contains the following files\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nrandom_folder/\n  data_basics.py\n  .gitignore\n```\n:::\n\n\nIn the `.gitignore` file add the following line \n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nvenv/\n```\n:::\n\n\nThis will prevent `git` from tracking this subfolder, which will be explained briefly\n\nThere are a few ways to manage our virtual environments\n\n1. Create a virtual environment inside each project/folder **(project-folder approach)**\n2. Create a single folder in your computer and keep all virtual environments there **(single-folder approach)**\n\nWe will take the **project-folder approach** and create a virtual environment inside `random_folder`.\n\nTo do so, run the following command on the terminal inside the `random_folder` directory\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\npython3 -m venv venv\n```\n:::\n\n\nUse `python3` for macOS and `python` for windows. After running the command, there should be a generated `venv` folder in our current directory \n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nrandom_folder/\n  data_basics.py\n  .gitignore\n  venv/\n```\n:::\n\n\n![](figures/env_yes.png){width=80%}\n\nIf you are using VS code then click on `Yes`\n\n\n## Activating a virtual environment \n\n\nNow our project has its own virtual environment, but we need to activate it each time we use initialize the project. Run the following command each time you want to activate the environment \n\n:::callout-warning\nYou must be in the current project directory for the above commands to work\n:::\n\n**macOS**\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nsource venv/bin/activate\n```\n:::\n\n\n**Windows**\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nvenv/Scripts/Activate.ps1\n```\n:::\n\n\n<details>\n<summary> Possible Error for Windows </summary>\n\n> \"cannot be loaded because the execution of scripts is disabled on this system\"\n\nopen Windows PowerShell as Administrator and run the following command \n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nSet-ExecutionPolicy Unrestricted -Force\n```\n:::\n\n\n</details>\n\nOnce we see the name of our virtual environment *(venv)* in our command prompt,\n\n\n![](figures/venv_activate.png){width=80%}\n\nThen the virtual environment has been successfully been activated. \nNow we can install the external packages such as NumPy and pandas \n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\npip install numpy pandas\n```\n:::\n\n\nRunning the command `pip list` will then show our current installed external packages *(and their dependencies)*\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\nPackage         Version\n--------------- -------\nnumpy           1.24.3\npandas          2.0.1\npip             22.0.4\npython-dateutil 2.8.2\npytz            2023.3\nsetuptools      58.1.0\nsix             1.16.0\ntzdata          2023.3\n```\n:::\n\n\nIt is generally not recommended to push the `venv` folder to GitHub because it can cause problems with version conflicts and unnecessarily bloat the repository. Instead, we will create a `requirements.txt` file that lists all the required dependencies and their versions. We can do so by running the following command \n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\npip freeze > requirements.txt\n```\n:::\n\n\nIn the generated `requirements.txt` file,  we should have something similar to *(versions will be different)*\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\nnumpy==1.24.3\npandas==2.0.1\npython-dateutil==2.8.2\npytz==2023.3\nsix==1.16.0\ntzdata==2023.3\n```\n:::\n\n\nThis file can then be committed to Github and used to recreate the virtual environment on other systems using the following command \n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\npip install -r requirements.txt\n```\n:::\n\n\n## Deactivating a virtual environment\n\nRun the following command \n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\ndeactivate\n```\n:::\n\n\nOnce you execute the `deactivate` command, your command prompt will return to its normal state, indicating that you have successfully exited the virtual environment. Any interactions with Python or pip from this point onward will be carried out using your globally configured Python environment, rather than the packages and dependencies installed in the virtual environment\n\n\nTo ensure that you are working in the appropriate environment for your project, it is important to `activate the virtual environment` each time you start working on it. After activating the virtual environment, select it as the Python interpreter in your development environment to ensure that you are using the packages and dependencies specific to this project\n\n![](figures/venv_interpreter.png){width=80%}\n\n",
    "supporting": [
      "03-virtualenv_files"
    ],
    "filters": [],
    "includes": {}
  }
}